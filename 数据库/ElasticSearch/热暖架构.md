# Hot-Warm Architecture
 [参考链接](https://blog.csdn.net/lanlianhua_luffy/article/details/110678077)
## 热暖架构
    热节点存放用户最关心的热数据；
        所有新输入的数据，并且存储速度也较快，以便确保快速地采集和检索数据。
    暖或冷节点存放用户不太关心或关心优先级低的冷数据或暖数据
        存储密度则较大，如需在较长保留期限内保留日志数据，不失为一种具有成本效益的方法。

    为了保证ES读写性能，官方建议磁盘使用SSD固态硬盘。然而ES要解决的是海量数据的存储和检索问题，海量的数据就意味需要大量的存储空间，如果都使用DDS固态硬盘成本将成为一个最大的问题，这也是制约许多企业和个人使用ES因素之一。为了解决这个问题，ES冷热分离架构应运而生。

## 应用场景
    日志用例，人们的大部分精力会专注在近期的日志（例如最近两周），而较早的日志（由于合规性或其他原因仍需要保留）则可以接受较慢的查询时间。

    在成本有限的前提下，让客户关注的实时数据和历史数据物理隔离，最大化解决客户响应时间慢的问题。

    每日增量6TB日志，高峰时刻写入以及查询频率都很高，集群压力较大，查询ES时，常出现查询缓慢问题。
        ES集群的索引写入及查询速度主要依赖于磁盘的IO速度，冷热数据分离的关键为使用SSD磁盘存储热数据，提升查询效率。
        若全部使用SSD，成本过高，且存放冷数据较为浪费，因而使用普通SATA磁盘与SSD磁盘混搭，可做到资源充分利用，性能大幅度提升的目标。

## 实现原理
    借助ES分片分配策略，

    第一、集群节点层面支持规划节点类型，这是划分热暖节点的前提。
        node.attr.temperature: hot // 热节点
        node.attr.temperature: cold // 冷节点
    第二、索引层面支持将数据路由到给定类型的节点，这为数据写入冷、热节点做了保障。
        在创建模板或索引时指定属性
        index.routing.allocation.include.{attribute}    // 索引可以分配在包含多个值中其中一个节点上
        index.routing.allocation.require.{attribute}    // 索引要分配在包含索引指定值的节点上
        index.routing.allocation.exclude.{attribute}    // 索引只能分配在不包含所有指定值的节点上